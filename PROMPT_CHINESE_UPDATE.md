# 🇨🇳 OCR 中文提示词更新

## 更新日期
2025-01-14

## 📋 更新内容

### 主要变更
将默认 OCR 提示词从英文改为**中文优化版本**，专门针对中英文混合内容的识别。

### 默认中文提示词

```
你是一个专业的 OCR（光学字符识别）助手。你的任务是从图片中提取文字内容并转换为 Markdown 格式。

严格要求：
1. 只输出 Markdown 内容本身 - 不要任何解释、不要开场白、不要"以下是内容"、不要"我已经识别"、不要道歉、绝对不要任何额外文字
2. 直接从 Markdown 内容开始（例如：# 标题，或直接是文字内容）
3. 保持原有结构：标题、列表、代码块、表格、强调、链接等
4. 使用正确的 Markdown 语法：# 表示标题，* 表示列表，` 表示代码，** 表示粗体
5. 如果图片包含代码，使用正确的代码块语法并标注语言标签
6. 如果图片包含表格，使用 Markdown 表格语法
7. 如果文字不清晰，尽力识别但不要添加占位符或说明
8. 不要包含任何对话填充词、元评论或解释

记住：只输出原始 Markdown 内容，除此之外不要有任何其他内容。
```

## ✨ 优势

### 中文提示词的优势
1. **更适合中文内容**: DeepSeek 模型对中文指令理解更好
2. **中英混合识别**: 同时优化中英文混合场景
3. **文化适应**: 符合中文使用习惯的表达方式
4. **明确指令**: "严格要求"比"STRICT REQUIREMENTS"更直接

### 技术细节
- ✅ 使用中文要求模型"只输出 Markdown"
- ✅ 明确禁止"以下是内容"等中文开场白
- ✅ 禁止"我已经识别"等中文说明
- ✅ 禁止道歉和解释性文字
- ✅ 保持技术格式（代码、表格、链接）

## 🚀 使用方法

### 方式1: 使用默认中文提示词（推荐）

**不需要做任何配置！**

只需在 `.env` 文件中设置 API Key：

```bash
SILICONFLOW_API_KEY=your_api_key_here
PORT=3014
```

系统会自动使用优化的中文默认提示词。

### 方式2: 自定义提示词

如果默认中文提示词不满足需求，可以在 `.env` 中自定义：

```bash
# 自定义提示词
OCR_PROMPT=你的自定义提示词内容...
```

## 📊 效果对比

### 英文提示词可能的问题
```markdown
好的，我来帮您识别这张图片的内容：

# 我的标题
内容...

以上是我识别的内容，如有问题请告知。
```

### 中文提示词的效果
```markdown
# 我的标题
内容...
```

**纯净的 Markdown，无任何额外文字！**

## 🔧 验证提示词是否生效

启动后端服务器时，会显示提示词信息：

```bash
$ npm run server

Server running on http://localhost:3014
OCR Prompt: 使用默认中文提示词
Prompt Length: 234 字符
```

如果设置了自定义提示词：
```bash
Server running on http://localhost:3014
OCR Prompt: 使用自定义提示词
Prompt Length: 156 字符
```

## 📁 相关文件

### 修改的文件
- `server/index.js`: 默认提示词改为中文版本
- `.env.example`: 更新为中文提示词示例

### 文档文件
- `OCR_PROMPT_GUIDE.md`: 提示词配置指南
- `PROMPT_UPDATE.md`: 英文版更新说明
- `PROMPT_CHINESE_UPDATE.md`: 本文档

## 🎯 测试建议

### 测试场景
1. **纯中文文档**: 测试中文识别准确性
2. **纯英文文档**: 测试英文识别准确性
3. **中英混合**: 测试混合内容识别
4. **代码截图**: 测试代码块格式保持
5. **表格图片**: 测试表格格式识别

### 评估标准
- ✅ 输出是否直接从 Markdown 内容开始
- ✅ 是否没有"以下是"、"我已经识别了"等开场白
- ✅ 是否没有道歉或说明性文字
- ✅ Markdown 格式是否正确（标题、列表、代码等）
- ✅ 特殊元素（代码、表格）是否正确识别

## 💡 提示词优化建议

### 如果 AI 仍然输出额外文字

尝试更强烈的措辞：

```bash
OCR_PROMPT=将图片转为Markdown。绝对禁止：1. 开场白 2. 解释 3. 道歉。只输出内容！
```

### 如果需要更好的代码识别

```bash
OCR_PROMPT=识别代码图片为Markdown。保留缩进，使用语法高亮标签。只输出代码，不要说明。
```

### 如果需要更好的表格识别

```bash
OCR_PROMPT=将表格转为Markdown格式。使用|分隔符。只输出表格，不要解释。
```

## 🔄 从英文提示词迁移

如果你之前使用了自定义的英文提示词：

1. **无需迁移**: 英文提示词仍然可以正常工作
2. **建议测试**: 测试中文提示词效果是否更好
3. **可选切换**: 根据效果决定是否切换到中文

迁移步骤（可选）：
```bash
# 之前的配置
OCR_PROMPT=You are an OCR assistant...

# 可以改为
OCR_PROMPT=你是一个OCR助手...

# 或者不设置，使用默认中文提示词
# （删除或注释掉 OCR_PROMPT 行）
```

## ⚠️ 注意事项

1. **重启服务**: 修改 `.env` 后需要重启后端服务
2. **字符编码**: 确保 `.env` 文件使用 UTF-8 编码
3. **特殊字符**: 如果提示词包含 ` ` 等特殊字符，可能需要转义
4. **多行提示**: `.env` 中建议使用单行，避免换行符问题

## 📞 反馈

如果你在使用中文提示词时遇到任何问题，或者有更好的优化建议，欢迎反馈！

## 📝 更新日志

- **v1.0** (2025-01-14): 切换默认提示词为中文版本
  - 默认提示词从英文改为中文
  - 优化中英文混合内容识别
  - 添加启动日志显示提示词状态
